@{
    ViewBag.Title = "Edit Test";
    Layout = "~/Views/Shared/_Layout.cshtml";
    L2Test.Helpers.EditTest ListHelp = new L2Test.Helpers.EditTest();
    ViewBag.ResultsURL = Url.Action("Edit", "Home", routeValues: null, protocol: Request.Url.Scheme);
}
<!--
 _____           _           _     _         _      _____   _____         _
|  __ \         | |         | |   | |       | |    / __  \ |_   _|       | |
| |  \/ ___   __| | __ _  __| | __| |_   _  | |    `' / /'   | | ___  ___| |_
| | __ / _ \ / _` |/ _` |/ _` |/ _` | | | | | |      / /     | |/ _ \/ __| __|
| |_\ \ (_) | (_| | (_| | (_| | (_| | |_| | | |____./ /___   | |  __/\__ \ |_
 \____/\___/ \__,_|\__,_|\__,_|\__,_|\__, | \_____/\_____/   \_/\___||___/\__|
                                      __/ |
                                     |___/
-->
<h1 style="color:orangered;">@ViewBag.Err</h1>


<!--Modal Buttons-->
<div class="container-fluid">
    <section class="row">
        <center>
            <div class="col-md-4">
                <div class="wrapper">
                    <button type="button" class="btn btn-lg" data-toggle="modal" data-target="#addModal">Add New Question</button>
                </div>
            </div>
            <div class="col-md-4">
                <div class="wrapper">
                    <button type="button" class="btn btn-lg" href="/Home/DownloadCSV">Export CSV File</button>
                </div>
            </div>
            <div class="col-md-4">
                <div class="wrapper">
                    <button type="button" class="btn btn-lg" data-toggle="modal" data-target="#importModal">Import CSV File</button>
                </div>
            </div>
        </center>
    </section>
</div>
<!--************************Import CSV*****************************-->
<div class="modal fade" id="importModal" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
  
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" id="editbtn" class="close" data-dismiss="modal">&times;</button>
                    <h2 class="modal-title">Upload CSV File</h2>
                </div>
                <div class="modal-body">
                    <form action="/Home/UploadCSV" method="post" enctype="multipart/form-data">
                        <div class="form-group">
                            <br />
                            <input type="file" name="FileUpload" id="file" />
                        </div>
                        <div class="form-group">
                            <label class="col-md-4 control-label" for="CSVAppend">Import Option</label>
                            <div class="col-md-4">
                                <div class="radio">
                                    <label for="CSVAppend-0">
                                        <input type="radio" name="CSVAppend" id="CSVAppend-0" value="1" checked="checked">
                                        Append to Test
                                    </label>
                                </div>
                                <div class="radio">
                                    <label for="CSVAppend-1">
                                        <input type="radio" name="CSVAppend" id="CSVAppend-1" value="2">
                                        Replace Test
                                    </label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                                <div class="col-md-6">
                                    <input type="submit" value="Submit" class="btn btn-info" />
                                </div>
                        </div>
                    </form>
                </div>  <!--Modal Body-->
        </div> <!--Modal Content-->
    </div> <!--Modal Dialog-->
</div><!--Modal-->
<!--************************Add Question***************************-->
<div class="modal fade" id="addModal" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" id="editbtn" class="close" data-dismiss="modal">&times;</button>
                <h2 class="modal-title">Add New Question</h2>
                <center><p>Put a check mark next to all correct answers.</p></center>
            </div>
            <div class="modal-body">
                <fieldset>
                    <!-- Get Question -->
                    <div class="form-group">
                        <label class="col-md-4 control-label" for="formQuestion">Question: </label>
                        <div class="col-md-6">
                            <textarea class="form-control" id="formQuestion" name="formQuestion" maxlength="799"></textarea>
                        </div>
                    </div>
                    <!-- Get Category -->
                    <div class="form-group">
                        <label class="col-md-4 control-label" for="formCategory">Select Category</label>
                        <div class="col-md-6">
                            <select id="formCategory" name="formCategory" class="form-control">
                                <option value="1">New Categoy</option>
                                @Html.Raw(ListHelp.CategoryList())
                            </select>
                        </div>
                    </div>
                    <!-- New Category-->
                    <div class="form-group">
                        <label class="col-md-4 control-label" for="newCategory">New Category</label>
                        <div class="col-md-6">
                            <input id="newCategory" name="newCategory" type="text" placeholder="" class="form-control input-md">
                        </div>
                    </div>
                    <!-- Get Answer1 -->
                    <div class="form-group">
                        <label class="col-md-4 control-label" for="formAnswer">Answer: </label>
                        <div class="col-md-6">
                            <div class="input-group">
                                <input id="formAnswer" name="formAnswer" class="form-control" type="text" maxlength="255">
                                <span class="input-group-addon">
                                    <input type="checkbox" name="formC" class="checkbox_check" value="1">
                                </span>
                            </div>
                        </div>
                    </div>
                    <br />
                    <!-- Get Answer2 -->
                    <div class="form-group">
                        <label class="col-md-4 control-label" for="formAnswer">Answer: </label>
                        <div class="col-md-6">
                            <div class="input-group">
                                <input id="formAnswer" name="formAnswer" class="form-control" type="text" maxlength="255">
                                <span class="input-group-addon">
                                    <input type="checkbox" name="formC" class="checkbox_check" value="1">
                                </span>
                            </div>
                        </div>
                    </div>
                    <!-- More Answers -->
                    <div id="AddHere"></div>
                    <!-- Submit Button -->
                    <div class="form-group">
                        <label class="col-md-4 control-label" for="submitButton"></label>
                        <div class="col-md-8">
                            <button class="btn btn-info" onclick="AddAnswer()"><span class="glyphicon glyphicon-plus"></span> More Answers</button>
                            <button id="SubmitButton" name="SubmitButton" class="btn btn-success" onclick="SendQuestion()">AddQuestion</button>
                        </div>
                    </div>
                </fieldset>
            </div>  <!--Modal Body-->

        </div> <!--Modal Content-->
    </div> <!--Modal Dialog-->
</div>

<!--************************List Questions*****************************-->
<br />
<ul class="Test" style="list-style-type:none">
    @Html.Raw(ListHelp.EditListString())
</ul>

@section scripts{
    <script>
        function AddAnswer() {
            $("<div class='form-group'><label class='col-md-4 control-label' for='formAnswer'>Answer: </label><div class='col-md-6'><div class='input-group'><input id='formAnswer' name='formAnswer' class='form-control' type='text' maxlength='255'><span class='input-group-addon'><input type='checkbox' name='formC' class='checkbox_check' value='1'></span></div></div></div>").insertBefore("#AddHere");
        }

        function SendQuestion() {
            var Answers = document.getElementsByName("formAnswer");
            var Corrects = document.getElementsByName("formC");

            var JSONObj = {};
            JSONObj.Question = document.getElementsByName("formQuestion")[0].value;
            JSONObj.QuestionID = "new";
            JSONObj.Catagory = document.getElementsByName("newCategory")[0].value;
            JSONObj.CategoryDropDown = document.getElementsByName("formCategory")[0].value;
            JSONObj.Answers = [];
            JSONObj.Corrects = [];

            for (var i = 0; i < Answers.length; i++) {
                JSONObj.Answers.push(Answers[i].value);
                if (Corrects[i].checked) {
                    JSONObj.Corrects.push(1);
                } else {
                    JSONObj.Corrects.push(0);
                }
            }

            $.ajax({
                url: "@(ViewBag.ResultsURL)",
                type: "POST",
                contentType: "application/json",
                dataType: "json",
                data: JSON.stringify(JSONObj),
                success: function (data) {
                    if (data != null) {
                        window.location.href = '@Url.Action("Edit", "Home")';
                    } else {
                        alert("ERROR:Data not submitted");
                    }
                }
            });
        }

    </script>
}