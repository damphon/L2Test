@{
    ViewBag.Title = "Edit Question";
    Layout = "~/Views/Shared/_Layout.cshtml";
    string CurrentQuestion = Path.GetFileName(Request.Url.ToString());
    L2Test.Models.TestModels ListHelp = new L2Test.Models.TestModels();
}

<h2>Edit</h2>

<ul class="Test" style="list-style-type:none">
    @Html.Raw(ListHelp.SingleQuestionString(CurrentQuestion))
</ul>

<!--************************Edit Buttons*****************************-->
<div class="container-fluid">
    <center>
        <div class="row">
            <div class="col-sm-2"></div>
            <div class="col-sm-4">
                <button type="button" class="btn btn-lg" data-toggle="modal" data-target="#editModal">Edit Question</button>
            </div>
                <div class="col-sm-4">
                    <button type="button" class="btn btn-lg" data-toggle="modal" data-target="#deleteModal">Remove Question From Test</button>
                </div>
            <div class="col-sm-2"></div>
            </div>
    </center>
 </div>
<!--************************Delete question*****************************-->
<!-- Modal -->
<div class="modal fade" id="deleteModal" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" id="gallerybtn" class="close" data-dismiss="modal">&times;</button>
                <h3 class="modal-title">Are you sure you want to remove this question?</h3>
            </div>
            <div class="modal-body">

                <!--FORM STARTS HERE-->
                <form action="@Url.Action("Delete", "Home")" method="post" enctype="multipart/form-data" class="form-horizontal">
                    <fieldset>
                        <input type="hidden" name="uid" value="@CurrentQuestion">
                        <!-- Delete Button -->
                        <div class="form-group">
                            <label class="col-md-4 control-label" for="submitButton"></label>
                            <div class="col-md-8">
                                <button id="submitButton" name="submitButton" class="btn btn-success">Remove Question</button>
                                <button class="btn btn-danger" data-dismiss="modal">Cancel</button>
                            </div>
                        </div>
                    </fieldset>
                </form> <!--FORM ENDS HERE-->
            </div>  <!--Modal Body-->

        </div> <!--Modal Content-->
    </div> <!--Modal Dialog-->
</div><!--End Modal-->

<!--************************Edit Question*****************************-->
<!-- Modal -->
<div class="modal fade" id="editModal" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" id="gallerybtn" class="close" data-dismiss="modal">&times;</button>
                <h3 class="modal-title">Edit Question:</h3>
            </div>
            <div class="modal-body">

                <!--FORM STARTS HERE-->
                <form action="" method="post" enctype="multipart/form-data" class="form-horizontal">
                    <fieldset>

                        <!-- Get Question -->
                        <div class="form-group">
                            <label class="col-md-4 control-label" for="formQuestion">Question: </label>
                            <div class="col-md-6">
                                <textarea class="form-control" id="formQuestion" name="formQuestion" maxlength="799"></textarea>
                            </div>
                        </div>
                        <!-- Get Answer1 -->
                        <div class="form-group">
                            <label class="col-md-4 control-label" for="formAnswer1">Answer: </label>
                            <div class="col-md-6">
                                <div class="input-group">
                                    <input id="formAnswer1" name="formAnswer1" class="form-control" type="text" maxlength="255">
                                    <span class="input-group-addon">
                                        <input type="checkbox" name="formC1" id="FC1" value="1">
                                    </span>
                                </div>
                                <p class="help-block">Check correct answers</p>
                            </div>
                        </div>
                        <!-- Get Answer2 -->
                        <div class="form-group">
                            <label class="col-md-4 control-label" for="formAnswer2">Answer: </label>
                            <div class="col-md-6">
                                <div class="input-group">
                                    <input id="formAnswer2" name="formAnswer2" class="form-control" type="text" maxlength="255">
                                    <span class="input-group-addon">
                                        <input type="checkbox" name="formC2" id="FC2" value="1">
                                    </span>
                                </div>
                            </div>
                        </div>
                        <!-- Get Answer3 -->
                        <div class="form-group">
                            <label class="col-md-4 control-label" for="formAnswer3">Answer: </label>
                            <div class="col-md-6">
                                <div class="input-group">
                                    <input id="formAnswer3" name="formAnswer3" class="form-control" type="text" maxlength="255">
                                    <span class="input-group-addon">
                                        <input type="checkbox" name="formC3" id="FC3" value="1">
                                    </span>
                                </div>
                            </div>
                        </div>
                        <!-- Get Answer4 -->
                        <div class="form-group">
                            <label class="col-md-4 control-label" for="formAnswer4">Answer: </label>
                            <div class="col-md-6">
                                <div class="input-group">
                                    <input id="formAnswer4" name="formAnswer4" class="form-control" type="text" maxlength="255">
                                    <span class="input-group-addon">
                                        <input type="checkbox" name="formC4" id="FC4" value="1">
                                    </span>
                                </div>
                            </div>
                        </div>
                        <!-- Get Catagory -->
                        <div class="form-group">
                            <label class="col-md-4 control-label" for="formCatagory">Select Catagory</label>
                            <div class="col-md-4">
                                <select id="formCatagory" name="formCatagory" class="form-control">
                                    <option value="1">New Catagoy</option>
                                    @Html.Raw(ListHelp.CatagoryList())
                                </select>
                            </div>
                        </div>
                        <!-- New Catagory-->
                        <div class="form-group">
                            <label class="col-md-4 control-label" for="newCatagory">New Catagory</label>
                            <div class="col-md-4">
                                <input id="newCatagory" name="newCatagory" type="text" placeholder="" class="form-control input-md">
                            </div>
                        </div>

                        <input type="hidden" name="uid" value="@CurrentQuestion">

                        <!-- Submit Button -->
                        <div class="form-group">
                            <label class="col-md-4 control-label" for="submitButton"></label>
                            <div class="col-md-8">
                                <button id="submitButton" name="submitButton" class="btn btn-info">Add Question</button>
                                <button class="btn btn-danger" data-dismiss="modal">Cancel</button>
                            </div>
                        </div>

                    </fieldset>
                </form> <!--FORM ENDS HERE-->
            </div>  <!--Modal Body-->

        </div> <!--Modal Content-->
    </div> <!--Modal Dialog-->
</div>

@section scripts{
    <script>
        $(window).load(function () {
            var testData = document.getElementById('TestData');
            document.getElementById('formQuestion').value = testData.getAttribute("question");
            document.getElementById('formAnswer1').value = testData.getAttribute("answer1");
            document.getElementById('formAnswer2').value = testData.getAttribute("answer2");
            document.getElementById('formAnswer3').value = testData.getAttribute("answer3");
            document.getElementById('formAnswer4').value = testData.getAttribute("answer4");

            if (testData.getAttribute("correct1") == "True") {
                document.getElementById('FC1').checked = true;
            }
            if (testData.getAttribute("correct2") == "True") {
                document.getElementById('FC2').checked = true;
            }
            if (testData.getAttribute("correct3") == "True") {
                document.getElementById('FC3').checked = true;
            }
            if (testData.getAttribute("correct4") == "True") {
                document.getElementById('FC4').checked = true;
            }
            
            for (var i = 0; i < document.getElementById('formCatagory').length; i++) {
                if(document.getElementById('formCatagory').options[i].value == testData.getAttribute("catagory"))
                    document.getElementById('formCatagory').selectedIndex = i;
            }
        })

        function textCounter(field, field2, maxlimit) {
            //Counts text entered in form and does not allow more than the maxlimit to be entered
            var countfield = document.getElementById(field2);
            if (field.value.length > maxlimit) {
                field.value = field.value.substring(0, maxlimit);
                return false;
            } else {
                countfield.value = field.value.length;
            }
        }
    </script>
}